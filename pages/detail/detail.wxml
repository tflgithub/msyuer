<import src="../../wxParse/wxParse.wxml" />
<import src="../../common/pageState/pageState.wxml" />
<template is="pageState" data="{{...pageState}}" />
<view class='mask' hidden='{{showKefu}}'>
  <view class='modal-content' style='height:250rpx;width:551rpx'>
    <text style='font-size:34rpx;color:#000;text-align:center;margin-top:50rpx'>回复数字"1",点击链接购买</text>
    <button class='confirm-btn' session-from='{"params":"id={{courseInfo.courseId}}"}' open-type="contact" style='color:#000000' bindtap='iosBuy'>确定</button>
  </view>
</view>
<scroll-view style='height:100%;width:100%;' scroll-y='true' bindscroll='onscroll'>
  <view style="width:750rpx;height:453rpx; position: relative;display:flex" wx:if='{{isShowCoverView}}'>
    <image src='{{courseInfo.phoUrl}}' style="width:750rpx;height:453rpx;" />
    <view style='position: absolute;top: 0;background:#000;opacity:0.2;width:750rpx;height:453rpx;' />
    <image src='../../image/ic_video.png' wx:if='{{hadFee}}' class='play-video' bindtap='startPlay' />
    <view wx:else class='play-ad' bindtap='startPlay'>
      <view style='font-size:32rpx;color:#FFFFFF;padding:10rpx 10rpx 10rpx 10rpx'>播放宣传片</view>
    </view>
  </view>
  <video wx:else id="myVideo" style="width:750rpx;height:453rpx;" objectFit='fill' src='{{videoUrl}}' controls='true' custom-cache='{{false}}'>
  </video>
  <view style='padding-left:30rpx;font-size:38rpx;padding-top:42rpx;padding-bottom:40rpx;background-color:#FFFFFF'>{{courseInfo.title}}</view>
  <view class="midlle">
    <view class='cell' style='margin-bottom:50rpx'>
      <view class='item'>
        <image src="../../image/ic_xuexi.png" style="width:32rpx;height:28rpx;margin-right:10rpx" />
        <view style='font-size:28rpx;color:#785B01'>{{courseInfo.learnNum}}人学习</view>
      </view>
    </view>
  </view>
  <view wx:if='{{officialAccount}}' style="margin-left:35rpx;margin-right:35rpx;margin-bottom:10rpx">
    <official-account></official-account>
  </view>
  <view wx:else class="wxParse" style='margin-left:40rpx;margin-right:40rpx'>
    <template is="wxParse" data="{{wxParseData:wxgz_article.nodes}}" />
  </view>
  <view class="{{top>330?'topnav':''}}">
  <view class="topTabSwiper">
    <view class='{{hadFee?"tab":"tab_half"}}  {{currentData == 0 ? "tabBorer" : ""}}' data-current="0" bindtap='checkCurrent'>
      课程信息
    </view>
    <view class='{{hadFee?"tab":"tab_half"}}  {{currentData == 1 ? "tabBorer" : ""}}' data-current="1" bindtap='checkCurrent'>线下课程</view>
    <view wx:if="{{hadFee}}" class='{{hadFee?"tab":"tab_half"}}  {{currentData == 2 ? "tabBorer" : ""}}' data-current="2" bindtap='checkCurrent'>课件</view>
  </view>
</view>
  <swiper current="{{currentData}}" style='height:1500rpx' duration="300" bindchange="bindchange">
    <!--课程信息-->
    <swiper-item>
      <view class='teacher'>
        <image src='{{teacherInfo.avatarUrl}}' mode='aspectFill' style='height:88rpx;width:88rpx;border-radius:50%;margin-top:40rpx;' />
        <view class='zhiwei'>讲师</view>
        <view class='info'>
          <text style='font-size:32rpx;color:#785B01;'>{{teacherInfo.name}}</text>
          <text style='font-size:26rpx;color:#000;'>{{teacherInfo.title}}</text>
        </view>
      </view>
      <view style='display:inline-flex;margin:40rpx 0 10rpx 40rpx;align-items:center;'>
        <image src='../../image/ic_kecheng.png' style='width:32rpx;height:28rpx' />
        <text style='font-size:28rpx;color:#000000;margin-left:10rpx'>课程介绍</text>
      </view>
      <view class="wxParse" style='margin-left:40rpx;margin-right:40rpx;margin-bottom:140rpx'>
        <template is="wxParse" data="{{wxParseData:article.nodes}}" />
      </view>
    </swiper-item>
    <!---关于米勺--->
    <swiper-item>
      <view class="wxParse" style='margin-left:40rpx;margin-right:40rpx'>
        <template is="wxParse" data="{{wxParseData:about_article.nodes}}" />
      </view>
    </swiper-item>
    <!--我的课件-->
    <swiper-item wx:if="{{hadFee}}">
      <view class="wxParse" style='margin-left:40rpx;margin-right:40rpx'>
        <template is="wxParse" data="{{wxParseData:kejian_article.nodes}}" />
      </view>
    </swiper-item>
  </swiper>


  <view class='bottom-buy' wx:if="{{courseInfo.price}}">
    <button style='background-color:#FFE28E;width:200rpx;height:80rpx;line-height:80rpx;border-radius:6rpx' ontap='listenerButton'>
      <image src='../../image/ic_fenxiang.png' style="vertical-align: middle;width:32rpx;height:31rpx;margin-right:10rpx " />
      <text style='font-size:28rpx'>分享</text>
    </button>
    <button disabled='{{canPay}}' style='width:395rpx;height:80rpx;background-color:#FFBD2D;font-size:28rpx;line-height:80rpx;text-align:center;border-radius:6rpx' ontap='buy'>我要学习
      <text hidden='{{hadFee}}' decode='{{true}}'>&nbsp;&nbsp;¥{{courseInfo.price}}</text>
    </button>
  </view>
</scroll-view>
<poster id="poster">
</poster>
<action-sheet hidden="{{actionSheetHidden}}" bindchange="listenerActionSheet">
   <action-sheet-item style='padding:2rpx;'><button style='border-radius:0;background-color:#FFFFFF' open-type='share'>分享给朋友</button></action-sheet-item>
   <action-sheet-item style='padding:2rpx;'>
   <poster id="poster" config="{{posterConfig}}" bind:success="onPosterSuccess" bind:fail="onPosterFail">
   <button style='border-radius:0;background-color:#FFFFFF'>生成海报</button>
   </poster>
   </action-sheet-item>
   <action-sheet-cancel>取消</action-sheet-cancel>
</action-sheet>